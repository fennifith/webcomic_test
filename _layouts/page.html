---
layout: default
---

<a href="{{ site.url }}" class="banner"><h1 class="banner__container"><img class="banner__icon" src="{{ site.url }}/images/favicon.svg">&nbsp;<span class="banner__name">{{ site.name }}</span></h1></a>

<main>
	{{ content }}
	
	<div class="paginator">
		{% assign pages = site.pages | sort: "hash" %}
	
		{% assign first = pages | first %}
		<a class="paginator__icon{% if first.url == page.url %} paginator__icon--disabled{% endif %}" href="{{ site.url }}{{ first.url }}" title="Jump to First">
			<i class="material-icons">first_page</i>
		</a>
		{% assign previousNum = page.hash | minus: 2 %}
		{% if previousNum >= 0 %}{% assign previous = pages[previousNum] %}{% endif %}
		<a class="paginator__icon{% if previous %}{% else %} paginator__icon--disabled{% endif %}" href="{{ site.url }}{{ previous.url }}" title="Previous" >
			<i class="material-icons">navigate_before</i>
		</a>

		<span class="paginator__text">{{ page.hash | plus: 0 }} of {{ site.pages.size }}</span>
		
		{% assign nextNum = page.hash | plus: 0 %}
		{% assign next = pages[nextNum] %}
		<a class="paginator__icon{% if next %}{% else %} paginator__icon--disabled{% endif %}" href="{{ site.url }}{{ next.url }}" title="Next">
			<i class="material-icons">navigate_next</i>
		</a>
		{% assign last = pages | last %}
		<a class="paginator__icon{% if last.url == page.url %} paginator__icon--disabled{% endif %}" href="{{ site.url }}{{ last.url }}" title="Jump to Last">
			<i class="material-icons">last_page</i>
		</a>
	</div>
	<div id="comic_dialog" class="dialog dialog--hidden">
		<a id="comic_close" class="dialog__close"><i class="material-icons">close</i></a>
		<iframe id="comic_iframe" class="dialog__content"></iframe>
	</div>
</main>

<script>
	var dialogElement = document.getElementById("comic_dialog");
	var dialogCloseElement = document.getElementById("comic_close");
	var dialogComicElement = document.getElementById("comic_iframe");
	var comics = document.getElementsByClassName("paper__item");

	// reset values on dialog close
	var onClose = function() {
		dialogElement.classList.add("dialog--hidden");
		document.body.classList.remove("--dialog");
		if (window.history.pushState)
		    window.history.pushState('', '/', window.location.pathname);
		else window.location.hash = '';
	};

	dialogCloseElement.addEventListener("click", onClose);
	dialogElement.addEventListener("click", onClose);

	// apply listeners to comic classes; open dialog when clicked
	for (var i in comics) {
		if (!comics[i] || !comics[i].addEventListener)
			continue;

		comics[i].addEventListener("click", function() {
			dialogComicElement.src = "{{ site.url }}" + this.getAttribute("data-url");
			dialogElement.classList.remove("dialog--hidden");
			document.body.classList.add("--dialog");
			window.location.hash = this.getAttribute("data-slug");
		});
	}

	// change hash on dialog change (ex: pagination widget used)
	var onLoad = function() {
		let path = this.contentWindow.location.pathname.split("/");
		if (path[1] === "comics" && !isNaN(path[2]) && parseInt(Number(path[2])) == path[2])
			window.location.hash = path[2];
	};	

	dialogComicElement.addEventListener("load", onLoad);
	dialogComicElement.onload = onLoad;

	// load comic in dialog if hash is set
	var hash = window.location.hash ? window.location.hash.substring(1) : null;
	if (hash && !isNaN(hash) && parseInt(Number(hash)) == hash) {
		dialogComicElement.src = "{{ site.url }}/comics/" + hash + "/";
		dialogElement.classList.remove("dialog--hidden");
		document.body.classList.add("--dialog");
	}
</script>
